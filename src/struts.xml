<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>

	<constant name="struts.objectFactory" value="spring" />

	<package name="default" extends="struts-default" namespace="/">
		<!-- Admin登录界面 -->
		<action name="adminlogin" class="adminAction" method="signin">
			<result name="success">/Login_success.jsp</result>
			<result name="input">/Admin_login.jsp</result>
		</action>
		<!-- 注册Librarian界面 -->
		<action name="librariansignup" class="librarianAction"
			method="signup">
			<result name="success">/Librarian_success.jsp</result>
			<result name="input">/Admin_login.jsp</result>
		</action>
		<!-- Admin 修改密码 -->
		<action name="changePassword" class="adminAction"
			method="changePassword">
			<result name="success">/Change_Success.jsp</result>
			<result name="input">/Login_success.jsp</result>
			<result name="login">/Admin_login.jsp</result>
		</action>
		<action name="logout" class="adminAction" method="logout">
			<result name="success">/Admin_login.jsp</result>
			<result name="failure">/Admin_login.jsp</result>
		</action>
		<action name="displayLibrarians" class="librarianAction"
			method="show">
			<result name="success">/Librarian.jsp</result>
		</action>


		<!-- Reader功能 -->
		<!-- 登录登出 -->
		<action name="readersignin" class="readerAction"
			method="signin">
			<result name="success" type="chain"><!--登录成功后跳转到借阅记录界面，后期需要更改 -->
				<param name="actionName">getBorrowPageByReader</param>
			</result>
			<result name="input">/Reader_signin.jsp</result>
		</action>

		<!-- Reader界面 -->
		<action name="readersignout" class="readerAction"
			method="signout"><!--登出后跳转到登录界面，后期需要更改 -->
			<result name="success">/Reader_signin.jsp</result>
		</action>
		<!-- 获取借阅记录 -->
		<action name="getReaderStatuForRecord" class="readerAction"
			method="getReaderStatu"><!--获取用户信息 -->
			<result name="success" type="chain"><!--若读者已经登录，获取借阅记录 -->
				<param name="actionName">getBorrowrecordByReader</param>
			</result>
			<result name="none">/Reader_signin.jsp</result><!--若读者未登录，跳转到登录界面 -->
		</action>
		<action name="getBorrowrecordByReader"
			class="borrowrecordAction" method="getBorrowrecordByReader"><!--依赖读者账户获取借阅记录 -->
			<result name="success" type="chain">
				<param name="actionName">getBooksbyBorrwrecords</param><!-- 若成功则去书籍信息 -->
			</result>
		</action>
		<action name="getAllBorrowrecord" class="borrowrecordAction"
			method="getAllBorrowrecord"><!-- 直接取得所有借阅记录 -->
			<result name="success" type="chain">
				<param name="actionName">getBooksbyBorrwrecords</param>
			</result>
		</action>
		<action name="getBooksbyBorrwrecords" class="bookAction"
			method="getBooksbyBorrwrecords"><!-- 依赖借阅记录获取对应的书籍信息 -->
			<result name="success">/Reader_borrowed.jsp</result><!--结束action，返回借阅记录界面 -->
		</action>
		<!-- 搜索书籍 -->
		<action name="searchBook" class="bookAction"
			method="searchBook">
			<result name="success">/category.jsp</result>
		</action>
		<!-- 分页查询 -->
		<action name="getReaderStatuForBorrowPage" class="readerAction"
			method="getReaderStatu"><!--获取用户信息 -->
			<result name="success" type="chain"><!--若读者已经登录，获取借阅记录 -->
				<param name="actionName">getBorrowPageByReader</param>
			</result>
			<result name="none">/Reader_signin.jsp</result><!--若读者未登录，跳转到登录界面 -->
		</action>
		<action name="getBorrowPageByReader" class="borrowrecordAction"
			method="getBorrowPageByReader">
			<result name="success" type="chain">
				<param name="actionName">getBooksbyBorrwrecords</param>
			</result>
			<result name="getfine" type="chain">
				<param name="actionName">getReaderFine</param><!-- 若fine为空，去取fine -->
			</result>
		</action>
		<!-- 获取尚未支付的罚金 -->
		<action name="getReaderFine" class="borrowrecordAction"
			method="getReaderFine">
			<result name="success" type="chain">
				<param name="actionName">getBooksbyBorrwrecords</param>
			</result>
		</action>


		<!-- Librarian添加书籍 -->
		<action name="addBook" class="bookAction" method="addBook">
			<result name="success" type="chain">displayBooks</result>
		</action>
		<!-- 跳转Librarian添加书籍界面 -->
		<action name="addBookPage" class="bookAction"
			method="addBookPage">
			<result name="success">/AddBook.jsp</result>
		</action>
		<!-- Librarian查看书籍列表 -->
		<action name="displayBooks" class="bookAction" method="display">
			<result name="success">/BookList.jsp</result>
		</action>
		<!-- Librarian删除书籍 -->
		<action name="deleteBook" class="bookAction"
			method="deleteBook">
			<result name="success" type="chain">displayBooks</result>
		</action>
		<!-- Librarian修改书籍信息 -->
		<action name="editBook" class="bookAction" method="editBook">
			<result name="success">/EditBook.jsp</result>
		</action>
		<!-- Admin删除馆员 -->
		<action name="deleteLibrarian" class="librarianAction"
			method="deleteLibrarian">
			<result name="success" type="chain">displayLibrarians</result>
		</action>
		<!-- Admin修改馆员信息 -->
		<action name="editLibrarian" class="librarianAction"
			method="editLibrarian">
			<result name="success">/EditLibrarian.jsp</result>
		</action>
	</package>
</struts>